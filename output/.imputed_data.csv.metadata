{"timestamp": 1682538379.227936, "stored_source_code": "# declare a list tasks whose products you want to use as inputs\nupstream = ['initial_cleaning']\nimport pandas as pd\n# read in the source file\ndf = pd.read_csv(upstream['initial_cleaning']['data'])\n\n# impute values with median\ndf['age'] = df.age.fillna(df.age.median)\ndf['rommservice'] = df.roomservice.fillna(df.roomservice.median)\ndf['foodcourt'] = df.foodcourt.fillna(df.foodcourt.median)\ndf['shoppingmall'] = df.shoppingmall.fillna(df.shoppingmall.median)\ndf['spa'] = df.spa.fillna(df.spa.median)\ndf['vrdeck'] = df.vrdeck.fillna(df.vrdeck.median)\n\n# impute the boolean\ndf['missing_cryo'] = 0\ndf.loc[df['cryosleep'].isna() == True, 'missing_cryo'] = 1\ndf['cryosleep'] = df['cryosleep'].fillna(False)\n\ndf['missing_vip'] = 0\ndf.loc[df['vip'].isna() == True, 'missing_vip'] = 1\ndf['vip'] = df['vip'].fillna(False)\n\n# impute missing char columns\ndf['missing_home'] = 0\ndf.loc[df['homeplanet'].isna() == True, 'missing_home'] = 1\ndf['homeplanet'] = df['homeplanet'].fillna('unknown')\n\ndf['missing_cabin'] = 0\ndf.loc[df['cabin'].isna() == True, 'missing_cabin'] = 1\ndf['cabin'] = df['cabin'].fillna('unknown')\n\ndf['missing_destination'] = 0\ndf.loc[df['destination'].isna() == True, 'missing_destination'] = 1\ndf['destination'] = df['destination'].fillna('unknown')\n\ndf['missing_name'] = 0\ndf.loc[df['name'].isna() == True, 'missing_name'] = 1\ndf['name'] = df['name'].fillna('unknown')\n# write out file\n\ndf.to_csv(product['data'], index = False)", "params": {}}